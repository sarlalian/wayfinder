# Pre-commit Setup for Wayfinder

This project uses pre-commit hooks to automatically format and lint Rust code before commits.

## Installation

### 1. Install pre-commit

```bash
# Using pip
pip install pre-commit

# Using brew (macOS)
brew install pre-commit

# Using apt (Ubuntu/Debian)
sudo apt install pre-commit
```

### 2. Install the hooks

Run this command from the project root:

```bash
pre-commit install
```

### 3. (Optional) Run hooks on all files

To run the hooks on all files in the repository (useful for initial setup):

```bash
pre-commit run --all-files
```

## What the hooks do

The pre-commit configuration includes the following checks:

### Rust-specific hooks:
- **`rust-fmt`** - Formats code using `cargo fmt`
- **`rust-clippy`** - Runs Clippy linter with warnings as errors
- **`rust-check`** - Verifies code compiles
- **`rust-test`** - Runs the test suite

### General hooks:
- **File size check** - Prevents large files (>1MB) from being committed
- **YAML/JSON validation** - Ensures workflow files have valid syntax
- **Merge conflict detection** - Catches unresolved merge conflicts
- **Trailing whitespace removal** - Keeps files clean
- **Private key detection** - Prevents accidental credential commits

## Manual execution

You can run specific hooks manually:

```bash
# Format code
pre-commit run rust-fmt --all-files

# Run clippy
pre-commit run rust-clippy --all-files

# Run all hooks
pre-commit run --all-files
```

## Bypassing hooks (emergency only)

If you absolutely need to commit without running hooks:

```bash
git commit --no-verify -m "Emergency commit message"
```

**Note**: This should be avoided in normal development workflow.

## Updating hooks

To update to the latest versions of hooks:

```bash
pre-commit autoupdate
```

This will update the hook versions in `.pre-commit-config.yaml`.
